We sort each word's letters to group them into classes. Then, by encoding patterns of repeated digits, we can construct a mapping from these patterns to the square strings matching them. This lets us quickly find squares with the same repeats for a given word pattern. Now, we can easily track the largest square in any valid pair.